pipeline {
    agent any
    tools {
        maven 'maven'
        jdk 'JDK11'
    }
    
    parameters {
        string(name: 'TAGS', defaultValue: '@login', description: 'Cucumber tags for the test, example @automated, @manual, @DFPORTALOB-31-002 etc ')
        choice(name: 'ENVIRONMENT', choices: ['uat', 'dev'], description: 'Choice environment dev or uat')

    }

   stages{
     stage('Build'){
          steps{
            script{
                if(isUnix()){
                    sh(script:"""
                    java --version
                    mkdir -p reports
                    node -v
                    npm i @cucumber/messages
                    npm i @cucumber/gherkin
                    npm i allure-playwright
                    npm i -D @playwright/test allure-playwright
                    npm i @cucumber/cucumber
                    npx playwright install    
                    npm i -D @playwright/test
                    npx playwright install

                    
                    """)
                } else{
                    bat(script:"""
                    java --version
                    mkdir -p reports
                    node -v
                    npm i @cucumber/gherkin
                    npm i allure-playwright
                    npm i @cucumber/cucumber
                    npx playwright install    
                    npm i -D @playwright/test

                    """)
                }
            }
          }
     }
   }
}
   def publishReport(){
    publishHTML(target: [
        allowMissing: true,
        reportDir: 'test-results/reports/index.html',

        
    ])
   }
                                                   
